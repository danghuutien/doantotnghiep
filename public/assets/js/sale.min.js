function applyCoupon(t){loadingBox(),$.ajax({type:"post",dataType:"json",data:{voucher:t},url:"/vouchers/price-after-voucher",success:function(t){1==t.status?($(".total_item_value.finally").text(t.data.price_after_sale_format),$("#price_sale").text(t.data.sale_price_format),$(".total_item.sale").show(),alert_show("success",t.message)):alert_show("error",t.message),$("#coupon_code").val(""),loadingBox("close")},error:function(t){loadingBox("close"),alert_show("error","Có lỗi xảy ra vui lòng thử lại!")}})}$(document).ready(function(){$("body").on("click",".action_cart",function(t){var o=$(this),e=o.data("id"),a=o.data("combo_id"),n=[];$(".action_cart-combo").each(function(t,o){$(o).data("combo_id")==a&&(n=[...n,$(o).data("id")])});var c=o.data("type");loadingBox(),$.ajax({type:"post",dataType:"json",data:{rowId:e,type:c,listRowId:n},url:"/ajax/edit-cart",success:function(t){$(".sale_content_table").empty(),$(".cart-count").text(t.count),$(".summary-total-price").text(t.totalcart),$(".subTotalcart").text(t.totalcart),$(".sale_content_table").append(t.html),loadingBox("close"),t.redirect?(alert_show("success","Giỏ hàng của bạn đang trống!"),setTimeout(function(){window.location.href=t.redirect},1e3)):alert_show("success","Cập nhật giỏ hàng thành công!"),lazyload()},error:function(t){loadingBox("close"),alert_show("error","Có lỗi xảy ra vui lòng thử lại!")}})}),$("body").on("click","#voucher_apply",function(t){let o=$(this).parent().find("#coupon_code").val();if(""==o)return alert_show("error","Mã giảm giá không được để trống!"),!1;applyCoupon(o)}),$("body").on("click",".item_apply button.apply",function(t){applyCoupon($(this).data("code"))}),$("body").on("click",".form-control",function(t){$(this).parent().find(".err_show").removeClass("active")}),$("body").on("click",".total_item_name .voucher_title",function(t){$(this).parent().find(".voucher_list").toggleClass("active")}),$('input[name="shipping_method"]').on("change",function(){$('input[name="shipping_method"]:checked').val()}),$("body").on("click",".choose-type-payment",function(t){t.preventDefault(),$(this).closest(".step-one").css("display","none"),$(".step-two").css("display","flex")}),$("body").on("click",".button_order",function(t){t.preventDefault(),$("#payment_method").val($(this).attr("value")).change();2==$('input[name="shipping_method"]:checked').val()&&$('input[name="address"]').removeClass("form-control"),1==validForm("form_checkout")&&(loadingBox("open"),$(this).closest("form").submit())})});